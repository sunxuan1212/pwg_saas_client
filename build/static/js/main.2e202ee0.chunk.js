(this.webpackJsonppwg_saas_client=this.webpackJsonppwg_saas_client||[]).push([[0],{276:function(e,t,n){e.exports=n(526)},281:function(e,t,n){e.exports=n.p+"static/media/logo.25bf045c.svg"},282:function(e,t,n){},341:function(e,t,n){e.exports=n.p+"static/media/noImageFound.3a5a71c0.png"},526:function(e,t,n){"use strict";n.r(t);var a=n(28),r=n(18),c=n(0),i=n.n(c),o=n(13),l=n.n(o),u=n(42),s=n(17),d=n.n(s),m=n(9),f=n(106),p=n(92),g=(n(281),n(282),function(e){return i.a.createElement("div",{id:"layout_01"},i.a.createElement("div",{className:"wrapper layout_01-wrapper"},i.a.createElement("div",{className:"header"},e.header?e.header:null),i.a.createElement("div",{className:"content"},e.children?e.children:null,i.a.createElement("div",{className:"footer"},e.footer?e.footer:null))))}),b=n(62),v=(n(100),n(37)),h=(n(51),n(12)),y=n(21),O=n(531),E=n(532),j=(n(127),n(58)),I=n(530),k=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a={title:e&&"string"==typeof e?e.toUpperCase():"...",icon:i.a.createElement(I.a,null),content:t,okType:"danger",onCancel:function(){j.a.destroyAll()}};null!=n&&(a.onOk=n),j.a[e](a)},x=n(35);function w(){var e=Object(r.a)(["\n  query config {\n    config {\n      _id\n      configId\n      defaultImage\n      defaultImage_system\n      imageSrc\n      paymentQRImage\n      server\n      profile {\n        name\n        notice\n      }\n      delivery\n    }\n  }\n"]);return w=function(){return e},e}function C(){var e=Object(r.a)(["\n  query config {\n    config @client {\n      _id\n      configId\n      defaultImage\n      defaultImage_system\n      imageSrc\n      paymentQRImage\n      server\n      profile {\n        name\n        notice\n      }\n      delivery\n    }\n  }\n"]);return C=function(){return e},e}function _(){var e=Object(r.a)(["\n  query userConfig($configId: String!) {\n    userConfig(configId: $configId) {\n        success\n        message\n        data\n    }\n  }\n"]);return _=function(){return e},e}function S(){var e=Object(r.a)(["\n  query user {\n    user {\n      success\n      message\n      data {\n        _id\n        username\n        configId\n      } \n    }\n  }\n"]);return S=function(){return e},e}function N(){var e=Object(r.a)(["\n  query user {\n    user @client {\n      success\n      message\n      data {\n        _id\n        username\n        configId\n      } \n    }\n  }\n"]);return N=function(){return e},e}var $=n(341),P=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=null;if(e){t=Object(x.a)({},e);var n=$;t.defaultImage&&""!=t.defaultImage&&(n=t.imageSrc+t.defaultImage),t.defaultImage=n}return t},A=d()(N()),D=d()(S()),F=function(){var e=Object(y.d)(A,{fetchPolicy:"cache-only"}),t=e.data,n=e.error,a=(e.loading,null);return n&&console.log("useUserCache",n),t&&t.user&&(a=t.user),a},q=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=Lt.client;null!=t&&(n=t),n.writeQuery({query:D,data:{user:e}})},R=(d()(_()),d()(C())),U=(d()(w()),function(){var e=Object(y.d)(R,{fetchPolicy:"cache-only"}),t=e.data,n=e.error,a=(e.loading,null);return n&&console.log("useConfigCache",n),t&&t.config&&(a=t.config),a}),V=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=Lt.client;null!=t&&(n=t),n.writeQuery({query:R,data:{config:P(e)}})};function T(){var e=Object(r.a)(["\n    mutation logout {\n      logout {\n        success\n        message\n        data\n      }\n    }\n"]);return T=function(){return e},e}var M=d()(T()),Q=function(e){var t,n=Object(y.a)(),a=Object(p.g)(),r=U(),o=Object(y.c)(M,{onCompleted:function(e){if(e&&e.logout&&e.logout.success){n.resetStore().then((function(){V(null),q(null)}))}}}),l=Object(m.a)(o,1)[0],u=Object(c.useState)(!1),s=Object(m.a)(u,2),d=s[0],f=s[1],g=[{name:"Inventory",icon:null,route:"/"},{name:"Orders",icon:null,route:"/orders"},{name:"Configuration",icon:null,route:"/configuration"}];return i.a.createElement("header",{id:"header_01","data-header-collapsed":d},i.a.createElement("div",{className:"header_01-header"},i.a.createElement("div",{className:"header_01-item collapse-btn"},i.a.createElement(h.a,(t={shape:"circle",type:"link"},Object(b.a)(t,"shape","circle"),Object(b.a)(t,"icon",i.a.createElement(O.a,{rotate:d?180:0})),Object(b.a)(t,"onClick",d?function(){f(!1)}:function(){f(!0)}),t)))),i.a.createElement("div",{className:"header_01-content"},function(){var e=[];return g.map((function(t,n){var r={shape:"circle"};d?r.shape="circle":r.type="link",e.push(i.a.createElement("div",{className:"header_01-item ".concat(a.location.pathname==t.route?"header_01-activeLink":""),key:n,onClick:function(){a.push(t.route)}},d?i.a.createElement(v.a,{title:t.name,placement:"right"},i.a.createElement(h.a,r,t.name[0].toUpperCase())):i.a.createElement("span",{className:a.location.pathname==t.route?"header_01-activeLink":""},t.name)))})),e}()),i.a.createElement("div",{className:"header_01-footer"},r&&!d?i.a.createElement("div",{className:"header_01-item",style:{cursor:"default"}},r.profile.name):null,i.a.createElement("div",{className:"header_01-item",onClick:function(){k("confirm","Confirm Logout?",(function(){l()}))}},d?i.a.createElement(v.a,{title:"Logout",placement:"right"},i.a.createElement(h.a,{shape:"circle",icon:i.a.createElement(E.a,null)})):i.a.createElement("span",null,"Logout"))))},z=(n(346),n(269),n(348),n(273),n(533),n(534),n(216),n(98)),B=(n(133),n(22)),L=(n(117),n(38)),J=n(535),W=function(e){var t=Object(c.useState)(!0),n=Object(m.a)(t,2),a=n[0];n[1];return a?i.a.createElement("div",{className:"loading"},i.a.createElement(J.a,null)):null},K=(n(354),n(268)),G=function(e){var t=e.type,n=void 0===t?"info":t,a=e.message;e.description;K.a[n]({message:a})};function Y(){var e=Object(r.a)(["\n  query userConfig($configId: String!) {\n    userConfig(configId: $configId) {\n        success\n        message\n        data\n    }\n  }\n"]);return Y=function(){return e},e}function H(){var e=Object(r.a)(["\n    mutation login($user: JSONObject) {\n      login(user: $user) {\n        success\n        message\n        data\n      }\n    }\n"]);return H=function(){return e},e}var X=d()(H()),Z=d()(Y()),ee={labelCol:{span:8},wrapperCol:{span:16}},te={wrapperCol:{offset:8,span:16}},ne=function(e){Object(p.g)();var t=Object(y.c)(X,{onCompleted:function(e){if(e&&e.login&&e.login.success){u({variables:{configId:e.login.data.configId}})}else G({type:"error",message:"Failed to login"})}}),n=Object(m.a)(t,2),a=n[0],r=n[1],c=r.data,o=r.loading,l=Object(y.b)(Z,{fetchPolicy:"cache-and-network",onCompleted:function(e){e&&e.userConfig&&e.userConfig.success&&(V(e.userConfig.data),q(c.login))}}),u=Object(m.a)(l,1)[0];return i.a.createElement("div",{id:"page_login"},i.a.createElement(B.a,Object.assign({},ee,{name:"basic",initialValues:{remember:!0},onFinish:function(e){a({variables:{user:e}})},onFinishFailed:function(e){console.log("Failed:",e)}}),i.a.createElement(B.a.Item,{label:"\u8d26\u53f7",name:"username",rules:[{required:!0,message:"Please input your username!"}]},i.a.createElement(L.a,null)),i.a.createElement(B.a.Item,{label:"\u5bc6\u7801",name:"password",rules:[{required:!0,message:"Please input your password!"}]},i.a.createElement(L.a.Password,null)),i.a.createElement(B.a.Item,Object.assign({},te,{name:"remember",valuePropName:"checked"}),i.a.createElement(z.a,null,"Remember me")),i.a.createElement(B.a.Item,te,i.a.createElement(h.a,{type:"primary",htmlType:"submit"},"\u767b\u5165"))),o?i.a.createElement(W,null):null)},ae=(n(139),n(94),n(528),n(267)),re=function(e){e.children;var t=Object(a.a)(e,["children"]);return i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{id:"page_01"},i.a.createElement(ae.a,t,e.children)))},ce=n(536),ie=(n(238),n(164)),oe=(n(230),n(168)),le=(n(231),n(109)),ue=n(111),se=n(23),de=n.n(se),me=n(44),fe=(n(193),n(61)),pe=(n(462),n(202)),ge=n(540),be=n(541),ve=(n(194),n(91)),he=n(272),ye=(n(239),n(125)),Oe=(n(234),n(124)),Ee=n(537),je=n(538),Ie=n(539),ke=n(254),xe=n.n(ke),we=L.a.Search,Ce=i.a.createContext(),_e=function(e){e.index;var t=Object(a.a)(e,["index"]),n=B.a.useForm(),r=Object(m.a)(n,1)[0];return i.a.createElement(B.a,{form:r,component:!1},i.a.createElement(Ce.Provider,{value:r},i.a.createElement("tr",t)))},Se=function(e){var t=e.title,n=e.editable,r=e.children,o=e.dataIndex,l=e.record,u=e.handleSave,s=e.isVariant,d=void 0!==s&&s,f=Object(a.a)(e,["title","editable","children","dataIndex","record","handleSave","isVariant"]),p=Object(c.useState)(!1),g=Object(m.a)(p,2),v=g[0],h=g[1],y=Object(c.useRef)(),O=Object(c.useContext)(Ce);Object(c.useEffect)((function(){v&&y.current.focus()}),[v]);var E=function(){h(!v),O.setFieldsValue(Object(b.a)({},o,l[o]))},j=function(){var e=Object(me.a)(de.a.mark((function e(t){var n;return de.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O.validateFields();case 3:n=e.sent,E(),u(Object(x.a)({},l,{},n)),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log("Save failed:",e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}(),I=r;return d?I=v?i.a.createElement(B.a.Item,{style:{margin:0,width:"100%",height:"100%"},name:o},i.a.createElement(L.a,{ref:y,onPressEnter:j,onBlur:j})):i.a.createElement("div",{className:"editable-cell-value-wrap",style:{paddingRight:24},onClick:E},r):n&&(I=v?i.a.createElement(B.a.Item,{style:{margin:0,width:"100%",height:"100%"},name:o,rules:[{required:!0,message:"".concat(t," is required.")}]},"price"==o?i.a.createElement(Oe.a,{ref:y,min:0,step:1,formatter:function(e){return"$ ".concat(e).replace(/\B(?=(\d{3})+(?!\d))/g,",")},parser:function(e){return e.replace(/\$\s?|(,*)/g,"")},onPressEnter:j,onBlur:j}):"stock"==o?i.a.createElement(Oe.a,{ref:y,min:0,step:1,onPressEnter:j,onBlur:j}):i.a.createElement(L.a,{ref:y,onPressEnter:j,onBlur:j})):i.a.createElement("div",{className:"editable-cell-value-wrap",style:{paddingRight:24},onClick:E},r)),i.a.createElement("td",f,I)},Ne=function(e){var t=e.productId,n=e.inventoryData,r=e.setInventoryData,o=e.productVariants,l=e.setProductVariants,u=Object(c.useState)([]),s=Object(m.a)(u,2),d=(s[0],s[1],Object(c.useState)(!1)),f=Object(m.a)(d,2),p=f[0],g=f[1],y=B.a.useForm(),O=Object(m.a)(y,1)[0],E=function(e){o[e];var t=Object(a.a)(o,[e].map(he.a));l(t);var c=n.map((function(t){return delete t[e],t}));r(c)},I=function(e,t,a){a.preventDefault();var c=n.map((function(e){return e.key})).indexOf(e.key);r(xe()(n,Object(b.a)({},c,{published:{$set:t}})))},k=function(e){r(n.filter((function(t){return t.key!==e})))},w=function(e){var t=Object(ue.a)(n),a=t.findIndex((function(t){return e.key===t.key})),c=t[a];t.splice(a,1,Object(x.a)({},c,{},e)),r(t)},C={body:{row:_e,cell:Se}},_=function(){var e=[],t=Object.keys(o),a=[{title:"Price",dataIndex:"price",editable:!0,width:100,fixed:"right",sorter:function(e,t){return e.price-t.price}},{title:"Stock",dataIndex:"stock",editable:!0,width:100,fixed:"right",sorter:function(e,t){return e.stock-t.stock}},{title:"Published",dataIndex:"published",width:100,fixed:"right",align:"center",render:function(e,t){return i.a.createElement("div",{style:{width:"100%",textAlign:"center",cursor:"pointer"}},i.a.createElement(oe.a,{checkedChildren:"Active",unCheckedChildren:"Inactive",checked:t.published,onChange:function(e,n){I(t,e,n)}}))}},{title:i.a.createElement(v.a,{title:"New Variant"},i.a.createElement(h.a,{onClick:function(){g(!0)},block:!0,type:"link",icon:i.a.createElement(ce.a,null),disabled:!(t.length<4)})),dataIndex:"operation",width:50,align:"center",fixed:"right",render:function(e,t){return n.length>=1?i.a.createElement(ye.a,{title:"Sure to delete?",onConfirm:function(){return k(t.key)}},i.a.createElement("div",{style:{width:"100%",textAlign:"center",cursor:"pointer"}},i.a.createElement(Ee.a,null))):null}}];return t&&t.length>0&&t.map((function(t){e.push({title:o[t],dataIndex:t,editable:!0,isVariant:!0,width:150,ellipsis:!0,sorter:function(e,n){return e[t]>n[t]?-1:n[t]>e[t]?1:0},filterIcon:i.a.createElement(je.a,null),filterDropdown:function(e){return i.a.createElement("div",{style:{padding:"10px",display:"flex"}},e.visible?i.a.createElement(i.a.Fragment,null,i.a.createElement(we,{enterButton:i.a.createElement(Ie.a,null),defaultValue:o[t],onSearch:function(n){return function(n){e.confirm(),l(Object(x.a)({},o,Object(b.a)({},t,n)))}(n)}}),i.a.createElement(ye.a,{title:"Sure to delete?",onConfirm:function(){e.confirm(),E(t)}},i.a.createElement(h.a,{type:"danger",icon:i.a.createElement(Ee.a,null),style:{marginLeft:"5px"}}))):null)},onFilter:function(){console.log("on filter ok")}})})),e.concat(a)}().map((function(e){return e.editable?Object(x.a)({},e,{onCell:function(t){return{record:t,editable:e.editable,dataIndex:e.dataIndex,title:e.title,isVariant:e.isVariant,handleSave:w}}}):e}));return i.a.createElement("div",{className:"inventoryTable-main"},i.a.createElement(h.a,{onClick:function(){var e={key:(new Date).getTime(),_id:null,price:0,stock:0,published:!1,productId:t};if(n.length>0){var c=n[n.length-1],i=(c.key,c._id,c.published,Object(a.a)(c,["key","_id","published"]));e=Object(x.a)({},e,{},i)}r([].concat(Object(ue.a)(n),[e]))},type:"primary",style:{marginRight:16,marginBottom:16},disabled:!(n.length<20),icon:i.a.createElement(ce.a,null)},"Item"),i.a.createElement(ve.a,{components:C,rowClassName:function(){return"editable-row"},bordered:!0,dataSource:n,columns:_,size:"small",pagination:!1,scroll:{x:150*(_.length-4)}}),i.a.createElement(B.a,{form:O},i.a.createElement(j.a,{title:"New Variant",width:300,bodyStyle:{paddingBottom:0},visible:p,onOk:function(){var e=O.getFieldValue();if(e&&e.variantName){var t="v"+(new Date).getTime();l(Object(x.a)({},o,Object(b.a)({},t,e.variantName))),O.resetFields()}g(!1)},onCancel:function(){g(!1)}},i.a.createElement(B.a.Item,{name:"variantName",rules:[{required:!0,message:"Name is required."}]},i.a.createElement(L.a,{maxLength:8})))))},$e=n(170),Pe=n(93),Ae=n(270),De=n(271);function Fe(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=new Ae.a({addTypename:!1}),n=new Pe.c({cache:t,link:new De.a({uri:e||"http://15.165.150.23/graphql",credentials:"include"})});return{client:n,cache:t,query:function(){var e=Object(me.a)(de.a.mark((function e(t){var a,r=arguments;return de.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=r.length>1&&void 0!==r[1]?r[1]:{},e.abrupt("return",new Promise((function(e,r){n.query({variables:a,query:t}).then((function(t){e(t)})).catch((function(e){r(e)}))})));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),mutation:function(){var e=Object(me.a)(de.a.mark((function e(t){var a,r=arguments;return de.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=r.length>1&&void 0!==r[1]?r[1]:{},e.abrupt("return",new Promise((function(e,r){n.mutate({variables:a,mutation:t}).then((function(t){e(t)})).catch((function(e){r(e)}))})));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}}function qe(){var e=Object(r.a)(["\n  mutation qiniuBatchDelete($images: [String!]) {\n    qiniuBatchDelete(images: $images) {\n      success\n      message\n      data\n    }\n  }\n"]);return qe=function(){return e},e}function Re(){var e=Object(r.a)(["\n  {\n    qiniuToken {\n      success\n      message\n      data\n    }\n  }\n"]);return Re=function(){return e},e}function Ue(){var e=Object(r.a)(["\n  {\n    qiniu @client {\n      success\n      message\n      data\n    }\n  }\n"]);return Ue=function(){return e},e}d()(Ue());var Ve=d()(Re()),Te=d()(qe()),Me=function(){var e=Object(me.a)(de.a.mark((function e(){var t,n,a,r=arguments;return de.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=!(r.length>0&&void 0!==r[0])||r[0],n=Fe(),a="",!t){e.next=7;break}return e.next=6,n.query(Ve).then((function(e){return e})).catch((function(e){}));case 6:a=e.sent;case 7:return e.abrupt("return",{upload:function(){var e=Object(me.a)(de.a.mark((function e(t){var n,r,c,i;return de.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.originFileObj,r={useCdnDomain:!0,region:$e.region.z0},c={fname:"",params:{},mimeType:["image/png","image/jpeg","image/gif"]},i=t.name,e.abrupt("return",new Promise((function(e,t){if(a){var o=a.data.qiniuToken;if(o.success){var l=o.data;$e.upload(n,i,l,c,r).subscribe({next:function(e){console.log("next(res)",e)},error:function(e){console.log("error(err)",e),t(e)},complete:function(t){console.log("complete(res)",t),e(t)}})}}else t("Error getting token")})));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),batchDelete:function(){var e=Object(me.a)(de.a.mark((function e(t){return de.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,a){n.mutation(Te,{images:t}).then((function(t){return e(t)})).catch((function(e){console.log(e),a(e)}))})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),imageMogr2:function(e,t,n){return $e.imageMogr2(e,t,n)}});case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();function Qe(){var e=Object(r.a)(["\n  mutation updateProduct($product: JSONObject!, $inventory: [JSONObject!]) {\n    updateProduct(product: $product, inventory: $inventory) {\n      success\n      message\n      data\n    }\n  }\n"]);return Qe=function(){return e},e}function ze(){var e=Object(r.a)(["\n  mutation deleteProduct($_id: String!) {\n    deleteProduct(_id: $_id) {\n      success\n      message\n      data\n    }\n  }\n"]);return ze=function(){return e},e}function Be(){var e=Object(r.a)(["\n  mutation createProduct($product: JSONObject!) {\n    createProduct(product: $product) {\n      success\n      message\n      data\n    }\n  }\n"]);return Be=function(){return e},e}function Le(){var e=Object(r.a)(["\n  query inventory($filter: JSONObject, $configId: String) {\n    inventory(filter: $filter, configId: $configId) {\n      _id\n      createdAt\n      updatedAt\n      price\n      stock\n      variants\n      published\n      productId\n    }\n  }\n"]);return Le=function(){return e},e}var Je=pe.a.Panel,We=fe.a.Option,Ke=d()(Le()),Ge=d()(Be()),Ye=d()(ze()),He=d()(Qe()),Xe=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=[],a=[],r=[],c=[];return t.map((function(e,t){var r=e.name;if(e.originFileObj){var i=r.split(".");r="saas_".concat(t,"_").concat((new Date).getTime(),"_").concat(i[i.length-2],".").concat(i[i.length-1]),e.name=r,n.push(e)}else a.push(e);c.push({name:r,fav:!!e.fav&&e.fav})})),e.map((function(e){a.map((function(e){return e.name})).indexOf(e.name)<0&&r.push(e)})),{upload:n,delete:r,allImages:c,uploaded:e}};function Ze(e){return new Promise((function(t,n){var a=new FileReader;a.readAsDataURL(e),a.onload=function(){return t(a.result)},a.onerror=function(e){return n(e)}}))}var et=function(e){var t=e.product,n=void 0===t?null:t,r=e.categories,o=e.refetch,l=Object(a.a)(e,["product","categories","refetch"]),u=U(),s=B.a.useForm(),d=Object(m.a)(s,1)[0],f=Object(c.useState)([]),p=Object(m.a)(f,2),g=p[0],b=p[1],v=Object(c.useState)(!1),O=Object(m.a)(v,2),E=O[0],I=O[1],w=Object(c.useState)(null),C=Object(m.a)(w,2),_=C[0],S=C[1],N=Object(c.useState)([]),$=Object(m.a)(N,2),P=$[0],A=$[1],D=Object(c.useState)([]),F=Object(m.a)(D,2),q=F[0],R=F[1],V=Object(c.useState)(""),T=Object(m.a)(V,2),M=T[0],Q=T[1],z=Object(c.useState)({sku:"SKU"}),J=Object(m.a)(z,2),W=J[0],K=J[1];Object(c.useEffect)((function(){if(l.modalVisible){if(R(r),n){var e=Object.assign({},n);if(n.category&&n.category.length>0){var t=n.category.map((function(e){return{key:e._id,label:e.name}}));e.category=t[0]}d.setFieldsValue(e),n.variants&&K(n.variants),te({variables:{filter:{filter:{productId:n._id}},configId:u.configId}}),n.images&&n.images.length>0&&b(function(e,t){var n=t.imageSrc;return e.map((function(e){return e.uid=e.name,e.url=n+e.name,e.thumbUrl=n+e.name,e.fav,e}))}(n.images,u))}}else d.resetFields();l.setModalFooter(we())}),[l.modalVisible]);var Y=i.a.createElement("div",null,i.a.createElement(ce.a,null),i.a.createElement("div",{className:"ant-upload-text"},"Upload")),H=function(){var e=[].concat(g);e.map((function(e){return e.name==_.name?e.fav=!0:e.fav=!1,e})),b(e)},X=function(){var e=Object(me.a)(de.a.mark((function e(t){return de.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.url||t.preview){e.next=4;break}return e.next=3,Ze(t.originFileObj);case 3:t.preview=e.sent;case 4:I(!0),S(t);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Z=Object(y.b)(Ke,{fetchPolicy:"cache-and-network",onCompleted:function(e){if(e&&e.inventory){var t=[];e.inventory.map((function(e,n){var r=e.variants,c=Object(a.a)(e,["variants"]),i=Object(x.a)({},c,{},r,{key:c._id});t.push(i)})),A(t)}}}),ee=Object(m.a)(Z,2),te=ee[0],ne=ee[1],ae=Object(y.c)(Ge,{onCompleted:function(e){l.onCancel(),o(),G({type:"success",message:"Success: Product Created"})}}),re=Object(m.a)(ae,2),se=re[0],ve=(re[1],Object(y.c)(Ye,{onCompleted:function(e){l.onCancel(),G({type:"success",message:"Success: Product deleted"}),o()}})),he=Object(m.a)(ve,1)[0],ye=Object(y.c)(He,{onCompleted:function(e){l.onCancel(),o(),G({type:"success",message:"Success: Product Updated"})}}),Oe=Object(m.a)(ye,2),Ee=Oe[0],je=(Oe[1],function(){var e=Object(me.a)(de.a.mark((function e(t){var r,c,i,o,l,u,s;return de.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.images,t.category,r=Object(a.a)(t,["images","category"]),c=Object(x.a)({},r,{category:[],images:[],variants:W}),t._id||delete c._id,t.category&&(i=q.find((function(e){return e._id==t.category.key})))&&i._id&&(c.category=[i]),o=Xe(n&&n.images?n.images:[],g),c.images=o.allImages,e.next=8,Me();case 8:if(l=e.sent,o.upload.length>0&&o.upload.map(function(){var e=Object(me.a)(de.a.mark((function e(t){return de.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l.upload(t);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),!(o.delete.length>0)){e.next=13;break}return e.next=13,l.batchDelete(o.delete.map((function(e){return e.name})));case 13:n?(u=(u=Object(ue.a)(P)).map((function(e){e.key;var t=Object(a.a)(e,["key"]),n={};return Object.keys(W).map((function(e){t.hasOwnProperty(e)&&(n[e]=t[e],delete t[e])})),t.variants=n,t})),s=[],ne.data&&ne.data.inventory&&ne.data.inventory.map((function(e){u.map((function(e){return e._id})).indexOf(e._id)<0&&s.push(Object(x.a)({},e,{deleted:!0}))})),Ee({variables:{product:Object(x.a)({},c,{_id:n._id}),inventory:u.concat(s)}})):se({variables:{product:c}});case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),Ie=function(){k("confirm","Confirm delete?",Object(me.a)(de.a.mark((function e(){var t;return de.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n.images&&n.images.length>0)){e.next=6;break}return e.next=3,Me();case 3:return t=e.sent,e.next=6,t.batchDelete(n.images.map((function(e){return e.name})));case 6:he({variables:{_id:n._id}});case 7:case"end":return e.stop()}}),e)}))))},ke=function(e){Q(e.target.value)},xe=function(){M&&""!=M&&(R([].concat(Object(ue.a)(q),[{_id:"category_".concat(M,"_").concat((new Date).getTime()),name:M}])),Q(""))},we=function(){var e=[i.a.createElement(h.a,{key:"cancel",onClick:l.onCancel},"Cancel"),i.a.createElement(h.a,{key:"submit",type:"primary",onClick:function(){d.submit()}},"Save")];return n&&e.unshift(i.a.createElement(h.a,{key:"delete",type:"danger",onClick:Ie},"Delete")),e};return i.a.createElement("div",{id:"productForm"},i.a.createElement(pe.a,{defaultActiveKey:["1","2"],expandIconPosition:"right"},i.a.createElement(Je,{header:"Product Information",key:"1"},i.a.createElement(B.a,{name:"complex-form",form:d,onFinish:je,labelCol:{span:5},wrapperCol:{span:16}},n?null:i.a.createElement(B.a.Item,{name:"_id",label:"ID"},i.a.createElement(L.a,null)),i.a.createElement(B.a.Item,{name:"name",label:"Name",rules:[{required:!0}]},i.a.createElement(L.a,null)),i.a.createElement(B.a.Item,{name:"description",label:"Description"},i.a.createElement(L.a.TextArea,{rows:4})),i.a.createElement(B.a.Item,{name:"category",label:"Category"},i.a.createElement(fe.a,{style:{width:240},placeholder:"Select a category",labelInValue:!0,allowClear:!0,dropdownRender:function(e){return i.a.createElement("div",null,e,i.a.createElement(le.a,{style:{margin:"4px 0"}}),i.a.createElement("div",{style:{display:"flex",flexWrap:"nowrap",padding:8}},i.a.createElement(L.a,{style:{flex:"auto"},value:M,onChange:ke,required:!0}),i.a.createElement(h.a,{type:"link",icon:i.a.createElement(ce.a,null),onClick:xe,disabled:""==M.trim()},"New")))}},q.map((function(e,t){return i.a.createElement(We,{key:t,value:e._id},e.name)})))),i.a.createElement(B.a.Item,{name:"published",label:"Published",valuePropName:"checked"},i.a.createElement(oe.a,{checkedChildren:"Active",unCheckedChildren:"Inactive"})),i.a.createElement(B.a.Item,{name:"images",label:"Images"},i.a.createElement(i.a.Fragment,null,i.a.createElement(ie.a,{accept:"image/*",beforeUpload:function(e){return!1},listType:"picture-card",multiple:!0,fileList:g,onPreview:X,onChange:function(e){var t=e.fileList,n=(Object(a.a)(e,["fileList"]),t.map((function(e){return e.fav,e})));(t.length>4&&(n=t.slice(0,3)),n.length>0)&&(n.find((function(e){return e.fav}))||(n[0].fav=!0));b(n)},className:"productForm-upload"},g.length<4?Y:null),i.a.createElement(j.a,{visible:E,footer:function(){var e=_&&_.fav;return i.a.createElement(h.a,{type:e?"primary":"default",icon:e?i.a.createElement(ge.a,{style:{color:"gold"}}):i.a.createElement(be.a,null),onClick:H},"Favourite")}(),onCancel:function(){I(!1)}},i.a.createElement("img",{alt:"preview: ".concat(_?_.name:""),style:{width:"100%"},src:_?_.url||_.thumbUrl:""})))))),n?i.a.createElement(Je,{header:"Pricing & Variants",key:"2"},i.a.createElement(Ne,{productId:n._id,inventoryData:P,setInventoryData:A,productVariants:W,setProductVariants:K})):null))},tt=function(e){var t=e.product,n=e.categories,a=void 0===n?[]:n,r=e.modalVisible,o=e.refetch,l=e.closeModal,u=Object(c.useState)([]),s=Object(m.a)(u,2),d=s[0],f=s[1],p={};return d&&(p.footer=d),i.a.createElement(j.a,Object.assign({title:t?t.name:"New Product",width:"95%",visible:r,onCancel:l,destroyOnClose:!0,wrapClassName:"products-modalWrapper",style:{overflow:"hidden"}},p),i.a.createElement(et,{product:t,categories:a,refetch:o,modalVisible:r,onCancel:l,setModalFooter:f}))},nt=(n(236),n(112));function at(){var e=Object(r.a)(["\n  query products($filter: JSONObject, $configId: String) {\n    products(filter: $filter, configId: $configId) {\n      _id\n      createdAt\n      updatedAt\n      name\n      description\n      category\n      variants\n      published\n      images\n    }\n  }\n"]);return at=function(){return e},e}d()(at());var rt=n(529);function ct(){var e=Object(r.a)(["\n  mutation updateInventoryPublish($ids: [String!], $published: Boolean!) {\n    updateInventoryPublish(ids: $ids, published: $published) {\n      success\n      message\n      data\n    }\n  }\n"]);return ct=function(){return e},e}function it(){var e=Object(r.a)(["\n  mutation updateProductPublish($ids: [String!], $published: Boolean!) {\n    updateProductPublish(ids: $ids, published: $published) {\n      success\n      message\n      data\n    }\n  }\n"]);return it=function(){return e},e}function ot(){var e=Object(r.a)(["\n  query inventory($filter: JSONObject, $configId: String) {\n    inventory(filter: $filter, configId: $configId) {\n      _id\n      createdAt\n      updatedAt\n      price\n      stock\n      variants\n      published\n      productId\n    }\n  }\n"]);return ot=function(){return e},e}function lt(){var e=Object(r.a)(["\n  query products($filter: JSONObject, $configId: String) {\n    products(filter: $filter, configId: $configId) {\n      _id\n      createdAt\n      updatedAt\n      name\n      description\n      category\n      variants\n      published\n      images\n    }\n  }\n"]);return lt=function(){return e},e}var ut=fe.a.Option,st=d()(lt()),dt=d()(ot()),mt=d()(it()),ft=d()(ct()),pt=function(e){var t=Object(c.useState)(!1),n=Object(m.a)(t,2),a=n[0],r=n[1],o=Object(c.useState)(null),l=Object(m.a)(o,2),u=l[0],s=l[1],d=Object(c.useState)([]),f=Object(m.a)(d,2),p=f[0],g=f[1],b=Object(c.useState)(!1),v=Object(m.a)(b,2),O=v[0],E=v[1],j=Object(c.useState)(""),I=Object(m.a)(j,2),k=I[0],w=I[1],C=U(),_=Object(y.d)(st,{fetchPolicy:"cache-and-network",variables:{filter:{sorter:{createdAt:1}},configId:C.configId},onError:function(e){console.log("products error",e)},onCompleted:function(e){}}),S=_.data,N=(_.loading,_.error),$=_.refetch,P=Object(y.d)(dt,{fetchPolicy:"cache-and-network",variables:{configId:C.configId},onError:function(e){console.log("inventoryData error",e)},onCompleted:function(e){}}),A=P.data,D=(P.loading,P.error),F=P.refetch,q=Object(y.c)(mt,{onCompleted:function(e){$()}}),R=Object(m.a)(q,1)[0],V=Object(y.c)(ft,{onCompleted:function(e){F()}}),T=Object(m.a)(V,1)[0];Object(c.useEffect)((function(){p.length>0?O||E(!0):O&&E(!1)}),[p.length]);var M=function(e){r(!0),s(e)},Q=[{title:"No.",dataIndex:"index",width:75,render:function(e,t,n){return n+1+"."}},{title:"Created At",dataIndex:"createdAt",key:"createdAt",sorter:function(e,t){return new Date(e.createdAt)-new Date(t.createdAt)},render:function(e,t){return Object(rt.a)(new Date(e),"MM/dd/yyyy hh:mm:ss aa")}},{title:"Name",dataIndex:"name",render:function(e,t){var n=t.name?i.a.createElement(h.a,{type:"link",onClick:function(){M(t)}},t.name):null;if(!n){var a="";if(t.variants){var r=Object.keys(t.variants);r.map((function(e,n){a+="".concat(t.variants[e]," ").concat(n==r.length-1?"":"/ ")}))}else a="-";n=a}return n}},{title:"Price",dataIndex:"price",render:function(e,t){var n=t.price;return n||(n="-"),n}},{title:"Stock",dataIndex:"stock",sorter:function(e,t){return e.stock&&t.stock?e.stock-t.stock:0},render:function(e,t){var n=t.stock;if(!n)if(t.children&&t.children.length>0){var a=0;t.children.map((function(e){a+=e.stock})),n=a}else n="-";return n}},{title:"Published",dataIndex:"published",render:function(e,t){return t.published?i.a.createElement(nt.a,{color:"green"},"Active"):i.a.createElement(nt.a,{color:"red"},"Inactive")}}],z={onChange:function(e,t){g(t)},onSelect:function(e,t,n){},onSelectAll:function(e,t,n){},selectedRowKeys:p.map((function(e){return e._id}))},B=(p.length,S&&S.products?function(e){var t=[];return e.map((function(e){e.category&&e.category.length>0&&e.category.map((function(e){t.find((function(t){return t._id==e._id}))||t.push(e)}))})),t}(S.products):[]),L=function(){var e,t=[];if(S&&A&&!N&&!D){var n=A.inventory.map((function(e){return Object(x.a)({},e,{key:e._id})}));(e=S.products,""!=k&&"none"!=k?e.filter((function(e){return!!e.category.find((function(e){return e._id==k}))})):"none"==k?e.filter((function(e){return 0==e.category.length})):e).map((function(e,a){var r=n.filter((function(t){return t.productId==e._id}));e.key=e._id,r.length>0&&(e.children=r),t.push(e)}))}return t}();return i.a.createElement(re,{title:"Inventory",extra:[i.a.createElement(h.a,{key:"create",type:"primary",icon:i.a.createElement(ce.a,null),onClick:function(){M(null)}})]},i.a.createElement(fe.a,{placeholder:"Category",onChange:function(e){w(e)},defaultValue:k,style:{minWidth:"35%",marginBottom:"24px"}},i.a.createElement(ut,{key:"all",value:""},"All"),B.map((function(e,t){return i.a.createElement(ut,{key:t,value:e._id},e.name)})),i.a.createElement(ut,{key:"none",value:"none"},"Without Category")),i.a.createElement(ve.a,{columns:Q,rowSelection:z,dataSource:L,pagination:!1,scroll:{x:150*Q.length},size:"small"}),i.a.createElement("div",{className:"inventory-selectionPanel ".concat(O?"open":"close")},function(){var e=[],t=[];p.map((function(n){n.productId&&""!=n.productId?e.push(n._id):t.push(n._id)}));return i.a.createElement("div",{style:{display:"flex"}},i.a.createElement(h.a,{type:"primary",size:"small",onClick:function(){e.length>0&&T({variables:{ids:e,published:!0}}),t.length>0&&R({variables:{ids:t,published:!0}})},style:{marginRight:"5px"},disabled:!O},"Publish"),i.a.createElement(h.a,{size:"small",onClick:function(){e.length>0&&T({variables:{ids:e,published:!1}}),t.length>0&&R({variables:{ids:t,published:!1}})},style:{marginRight:"5px"},disabled:!O},"Unpublish"),i.a.createElement(h.a,{size:"small",onClick:function(){g([])}},"Cancel"))}()),i.a.createElement(tt,{product:u,categories:B,refetch:function(){$(),F()},modalVisible:a,closeModal:function(){r(!1)}}))},gt=(n(501),n(201)),bt=(n(503),n(47)),vt=(n(505),n(172)),ht=(n(229),n(157)),yt=function(e){var t=e.order,n=e.closeModal,r=e.visible,c=(Object(a.a)(e,["order","closeModal","visible"]),U());return i.a.createElement(j.a,{title:"Order",width:"95%",visible:r,onCancel:n,footer:null,wrapClassName:"products-modalWrapper",style:{overflow:"hidden"}},t?i.a.createElement(i.a.Fragment,null,i.a.createElement(le.a,{orientation:"left"},"\u8ba2\u5355"),i.a.createElement(bt.a,{size:"small",bordered:!0,column:{xxl:2,xl:2,lg:2,md:2,sm:1,xs:1}},i.a.createElement(bt.a.Item,{label:"\u7f16\u53f7"},t._id),i.a.createElement(bt.a.Item,{label:"\u8ba2\u8d2d\u65e5\u671f"},Object(rt.a)(new Date(t.createdAt),"MM/dd/yyyy hh:mm:ss aa")),i.a.createElement(bt.a.Item,{label:"\u4ed8\u6b3e\u72b6\u6001"},t.paid?i.a.createElement("span",{style:{color:"green"}},"\u5df2\u4ed8\u6b3e"):i.a.createElement("span",{style:{color:"red"}},"\u5f85\u4ed8\u6b3e")),i.a.createElement(bt.a.Item,{label:"\u8d27\u7269\u72b6\u6001"},t.sentOut?i.a.createElement("span",{style:{color:"green"}},"\u5df2\u51fa\u8d27 ",i.a.createElement("small",null," (\u8fd0\u5355\u53f7: ",t.trackingNum,")")):i.a.createElement("span",{style:{color:"red"}},"\u672a\u51fa\u8d27"))),i.a.createElement(le.a,{orientation:"left"},"\u6536\u4ef6\u4eba"),i.a.createElement(bt.a,{id:"buyerInfoTable",size:"small",bordered:!0,column:{xxl:1,xl:1,lg:1,md:1,sm:1,xs:1}},i.a.createElement(bt.a.Item,{label:"\u540d\u5b57"},t.customer.name),i.a.createElement(bt.a.Item,{label:"\u7535\u8bdd\u53f7\u7801"},t.customer.contact),i.a.createElement(bt.a.Item,{label:"\u6536\u4ef6\u5730\u5740"},t.customer.address),i.a.createElement(bt.a.Item,{label:"\u90ae\u7f16"},t.customer.postcode),i.a.createElement(bt.a.Item,{label:"\u7701\u4efd"},t.customer.province)),i.a.createElement(le.a,{orientation:"left"},"\u8d2d\u4e70\u5217\u8868"),i.a.createElement(vt.b,{itemLayout:"horizontal",dataSource:t.items,renderItem:function(e){var t=e.product.name,n="";console.log("item",e);var a=Object.keys(e.variant);a.map((function(t,r){n+="".concat(e.variant[t].name,": ").concat(e.variant[t].value).concat(r==a.length-1?"":", ")}));var r="";return c&&e.product.image&&(r=c.imageSrc+e.product.image),i.a.createElement(vt.b.Item,{actions:["qty: "+e.qty,"price: "+e.price]},i.a.createElement(vt.b.Item.Meta,{avatar:i.a.createElement(ht.a,{shape:"square",src:r}),title:t,description:n}))},footer:i.a.createElement("div",{className:"orderInfo-item-summary"},i.a.createElement(bt.a,{bordered:!0,size:"small",column:{xxl:1,xl:1,lg:1,md:1,sm:1,xs:1},style:{maxWidth:"100%"}},i.a.createElement(bt.a.Item,{label:"\u90ae\u8d39"},t.deliveryFee?t.deliveryFee:0),i.a.createElement(bt.a.Item,{label:"\u603b\u8ba1"},t.total)))}),i.a.createElement("div",{className:"orderInfo-extra"},c.paymentQRImage?i.a.createElement("div",{style:{textAlign:"center",flexGrow:1}},i.a.createElement("img",{src:c.imageSrc+c.paymentQRImage})):null,t.sentOut&&t.trackingNum?i.a.createElement("div",{style:{textAlign:"center",flexGrow:1}},i.a.createElement("iframe",{src:"https://m.kuaidi100.com/app/query/?coname=indexall&nu=".concat(t.trackingNum),style:{border:"none",maxWidth:"400px",height:"600px",textAlign:"center"}})):null)):"Not found")};function Ot(){var e=Object(r.a)(["\n  mutation cancelOrder($_id: String!) {\n    cancelOrder(_id: $_id) {\n      success\n      message\n      data\n    }\n  }\n"]);return Ot=function(){return e},e}function Et(){var e=Object(r.a)(["\n  mutation updateOrderDelivery($_id: String!, $trackingNum: String) {\n    updateOrderDelivery(_id: $_id, trackingNum: $trackingNum) {\n      success\n      message\n      data\n    }\n  }\n"]);return Et=function(){return e},e}function jt(){var e=Object(r.a)(["\n  mutation updateOrderPayment($_id: String!, $paid: Boolean!) {\n    updateOrderPayment(_id: $_id, paid: $paid) {\n      success\n      message\n      data\n    }\n  }\n"]);return jt=function(){return e},e}function It(){var e=Object(r.a)(["\n  query orders($filter: JSONObject, $configId: String) {\n    orders(filter: $filter, configId: $configId) {\n      _id\n      createdAt\n      updatedAt\n      items\n      total\n      customer\n      paid\n      sentOut\n      trackingNum\n      deliveryFee\n    }\n  }\n"]);return It=function(){return e},e}var kt=gt.a.TabPane,xt=L.a.Search,wt=d()(It()),Ct=d()(jt()),_t=d()(Et()),St=d()(Ot()),Nt=function(e){var t=U(),n=Object(c.useState)(!1),a=Object(m.a)(n,2),r=a[0],o=a[1],l=Object(c.useState)(null),u=Object(m.a)(l,2),s=u[0],d=u[1],f=Object(y.d)(wt,{fetchPolicy:"cache-and-network",variables:{filter:{sorter:{createdAt:"desc"}},configId:t.configId},onError:function(e){console.log("products error",e)},onCompleted:function(e){}}),p=f.data,g=(f.loading,f.error,f.refetch),b=Object(y.c)(Ct,{onCompleted:function(e){g()}}),v=Object(m.a)(b,2),O=v[0],E=(v[1],Object(y.c)(_t,{onCompleted:function(e){g()}})),j=Object(m.a)(E,2),I=j[0],k=(j[1],Object(y.c)(St,{onCompleted:function(e){g()}})),x=Object(m.a)(k,2),w=x[0],C=(x[1],[{title:"No.",dataIndex:"index",key:"index",width:75,render:function(e,t,n){return"".concat(n+1,".")}},{title:"\u8ba2\u8d2d\u65e5\u671f",dataIndex:"createdAt",key:"createdAt",sorter:function(e,t){return new Date(e.createdAt)-new Date(t.createdAt)},render:function(e,t){return Object(rt.a)(new Date(e),"MM/dd/yyyy hh:mm:ss aa")}},{title:"\u8ba2\u5355\u7f16\u53f7",dataIndex:"_id",key:"_id",render:function(e,t){return i.a.createElement("a",{style:{whiteSpace:"pre-wrap",textDecoration:"underline"},onClick:function(){!function(e){o(!0),d(e)}(t)}},t._id.toUpperCase())}},{title:"\u6536\u8d27\u4eba",dataIndex:"customer",key:"customer",sorter:function(e,t){return e.name-t.name},render:function(e,t){return e.name}},{title:"\u603b\u8ba1",dataIndex:"total",key:"total",sorter:function(e,t){return e.total-t.total}}]),_=(i.a.createElement("div",null,"\u7a7a\u7a7a\u5982\u4e5f"),{newOrders:[].concat(C,[{title:"\u4ed8\u6b3e\u72b6\u6001",dataIndex:"paid",key:"paid",render:function(e,t){return i.a.createElement(h.a,{size:"small",type:"".concat(e?"primary":"danger"),onClick:function(){O({variables:{_id:t._id,paid:!t.paid}})}},e?"\u5df2\u4ed8\u6b3e":"\u672a\u4ed8\u6b3e")}},{title:"",dataIndex:"action",key:"action",render:function(e,t){return i.a.createElement(ye.a,{title:"Sure to delete?",onConfirm:function(){w({variables:{_id:t._id}})}},i.a.createElement(h.a,{type:"danger",size:"small"},"\u53d6\u6d88"))}}]),paidOrders:[].concat(C,[{title:"\u4ed8\u6b3e\u72b6\u6001",dataIndex:"paid",key:"paid",render:function(e,t){return i.a.createElement(h.a,{type:"".concat(e?"primary":"danger"),size:"small",onClick:function(){O({variables:{_id:t._id,paid:!t.paid}})}},e?"\u5df2\u4ed8\u6b3e":"\u672a\u4ed8\u6b3e")}},{title:"Tracking No.",dataIndex:"trackingNum",key:"trackingNum",width:200,render:function(e,t){return t.sentOut&&e?i.a.createElement("div",null,e):i.a.createElement(xt,{placeholder:"Enter tracking no.",enterButton:i.a.createElement(Ie.a,null),size:"small",onSearch:function(e){I({variables:{_id:t._id,trackingNum:e}})}})}}]),completedOrders:[].concat(C,[{title:"Last Updated",dataIndex:"updatedAt",key:"updatedAt",sorter:function(e,t){return new Date(e.updatedAt)-new Date(t.updatedAt)},render:function(e,t){return Object(rt.a)(new Date(e),"MM/dd/yyyy hh:mm:ss aa")}},{title:"Tracking No.",dataIndex:"trackingNum",key:"trackingNum",render:function(e,t){return e}}])}),S=function(){var e=p?p.orders:[],t=[],n=[],a=[];return e.map((function(e){e.paid||e.sentOut?e.paid&&!e.sentOut?n.push(e):e.paid&&e.sentOut&&a.push(e):t.push(e)})),{newOrders:t,paidOrders:n,completedOrders:a}}();return i.a.createElement(re,{title:"Orders"},i.a.createElement(gt.a,{defaultActiveKey:"1"},i.a.createElement(kt,{tab:"New Orders",key:"1"},i.a.createElement(ve.a,{rowKey:"_id",columns:_.newOrders,dataSource:S.newOrders,pagination:!1,size:"small",scroll:{x:100*_.newOrders.length},footer:null})),i.a.createElement(kt,{tab:"Paid Orders",key:"2"},i.a.createElement(ve.a,{rowKey:"_id",columns:_.paidOrders,dataSource:S.paidOrders,pagination:!1,size:"small",scroll:{x:100*_.paidOrders.length},footer:null})),i.a.createElement(kt,{tab:"Completed Orders",key:"3"},i.a.createElement(ve.a,{rowKey:"_id",columns:_.completedOrders,dataSource:S.completedOrders,pagination:!1,size:"small",scroll:{x:100*_.completedOrders.length},footer:null}))),i.a.createElement(yt,{order:s,visible:r,closeModal:function(){o(!1)}}))};n(525);function $t(){var e=Object(r.a)(["\n  mutation updateConfig($config: JSONObject, $configId: String!) {\n    updateConfig(config: $config, configId: $configId) {\n      success\n      message\n      data\n    }\n  }\n"]);return $t=function(){return e},e}var Pt=d()($t()),At=function(e){var t=U(),n=B.a.useForm(),a=Object(m.a)(n,1)[0],r=Object(c.useState)([]),o=Object(m.a)(r,2),l=o[0],u=o[1],s=Object(y.c)(Pt,{onCompleted:function(e){console.log("UPDATE_CONFIG_QUERY",e.updateConfig.data.value),V(e.updateConfig.data.value),G({type:"success",message:"Success: Configuration Updated"})},onError:function(e){console.log("UPDATE_CONFIG_QUERY err",e),G({type:"success",message:"Error: Error while updating Configuration"})}}),d=Object(m.a)(s,1)[0];Object(c.useEffect)((function(){null!=t&&(t.paymentQRImage&&""!=t.paymentQRImage&&u([{uid:t.paymentQRImage,url:t.imageSrc+t.paymentQRImage,thumbUrl:t.imageSrc+t.paymentQRImage}]),a.setFieldsValue({notice:t.profile.notice,delivery:t.delivery}))}),[t]);var f=i.a.createElement("div",null,i.a.createElement(ce.a,null),i.a.createElement("div",{className:"ant-upload-text"},"Upload")),p=function(){var e=Object(me.a)(de.a.mark((function e(n){var a,r,c,i,o,u,s,m;return de.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("handleSubmit",n),console.log("filelist",l),a={"profile.notice":n.notice,delivery:n.delivery},r=!1,c=t.paymentQRImage,i="",l.length>0?l[0].originFileObj&&c!=l[0].name&&(o=l[0].name.split("."),u="saas_payment_".concat((new Date).getTime(),"_").concat(o[o.length-2],".").concat(o[o.length-1]),i=u,r=!0):""!=c&&(i="",r=!0),!t||!t.configId){e.next=26;break}if(!r){e.next=25;break}return a.paymentQRImage=i,e.next=12,Me();case 12:if(s=e.sent,""==i){e.next=22;break}return m=Object(x.a)({},l[0],{name:i}),e.next=17,s.upload(m);case 17:if(""==c){e.next=20;break}return e.next=20,s.batchDelete([t.paymentQRImage]);case 20:e.next=25;break;case 22:if(""==c){e.next=25;break}return e.next=25,s.batchDelete([t.paymentQRImage]);case 25:d({variables:{config:a,configId:t.configId}});case 26:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return i.a.createElement(re,{title:"Configuration"},i.a.createElement(B.a,{form:a,onFinish:p,layout:"vertical"},i.a.createElement(B.a.Item,{label:"Notice",name:"notice"},i.a.createElement(L.a.TextArea,null)),i.a.createElement(B.a.Item,{label:"Delivery Fee (Static)",name:"delivery"},i.a.createElement(Oe.a,null)),i.a.createElement(B.a.Item,{label:"Payment QR",name:"paymentQRImage"},i.a.createElement(ie.a,{accept:"image/*",beforeUpload:function(e){return console.log("beforeUpload",e),!1},listType:"picture-card",fileList:l,onChange:function(e){var t=e.fileList;u(t)},customRequest:function(){console.log("haha")}},l.length<1?f:null)),i.a.createElement(B.a.Item,null,i.a.createElement(h.a,{type:"primary",onClick:function(){a.submit()}},"Save"))))},Dt=function(e){var t=e.component,n=Object(a.a)(e,["component"]),r=Object(p.h)(),c=F(),o=U(),l=!1;return c&&c.success&&o&&(l=!0),i.a.createElement(p.b,Object.assign({},n,{render:function(e){return l?i.a.createElement(t,e):i.a.createElement(p.a,{to:{pathname:"/login",state:{from:r}}})}}))},Ft=function(e){var t=e.component,n=e.restricted,r=Object(a.a)(e,["component","restricted"]),c=Object(p.h)(),o=F(),l=U(),u=!1;return o&&o.success&&l&&(u=!0),i.a.createElement(p.b,Object.assign({},r,{render:function(e){return u&&n?i.a.createElement(p.a,{to:{pathname:"/",state:{from:c}}}):i.a.createElement(t,e)}}))},qt=function(){return i.a.createElement("div",null,"404: Page Not Found")},Rt=g,Ut=Q,Vt=function(e){var t=Object(c.useState)(!1),n=Object(m.a)(t,2),a=n[0],r=n[1],o=U();Object(c.useEffect)((function(){r(!!o)}),[o]);return i.a.createElement(f.a,null,i.a.createElement(Rt,{header:a?i.a.createElement(Ut,null):null,footer:a?"2020":null},i.a.createElement(p.d,null,i.a.createElement(Dt,{exact:!0,path:"/",component:pt}),i.a.createElement(Dt,{exact:!0,path:"/main",component:function(){return i.a.createElement("div",null,"Main")}}),i.a.createElement(Dt,{exact:!0,path:"/orders",component:Nt}),i.a.createElement(Dt,{exact:!0,path:"/configuration",component:At}),i.a.createElement(Ft,{restricted:!0,exact:!0,path:"/login",component:ne}),i.a.createElement(p.b,{component:qt}))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function Tt(){var e=Object(r.a)(["\n  query userConfig($configId: String!) {\n    userConfig(configId: $configId) {\n        success\n        message\n        data\n    }\n  }\n"]);return Tt=function(){return e},e}function Mt(){var e=Object(r.a)(["\n  query loggedInUser{\n    loggedInUser{\n        success\n        message\n        data\n    }\n  }\n"]);return Mt=function(){return e},e}var Qt=d()(Mt()),zt=d()(Tt()),Bt=Fe(),Lt=t.default=Bt,Jt=Bt.client,Wt=(Bt.cache,Object(a.a)(Bt,["client","cache"]));Jt.writeData({data:{user:null,config:null}});!function(){var e=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;null!=e&&null!=t&&(q(e,Jt),V(t,Jt)),l.a.render(i.a.createElement(u.a,{client:Jt},i.a.createElement(Vt,null)),document.getElementById("root"))};Wt.query(Qt).then((function(t){var n=t.data.loggedInUser;Wt.query(zt,{configId:n.data.configId}).then((function(t){var a=t.data.userConfig.data;e(n,a)})).catch((function(t){console.log("error2",t),e()}))})).catch((function(t){console.log("error",t),e()}))}(),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[276,1,2]]]);
//# sourceMappingURL=main.2e202ee0.chunk.js.map